/* http://keith-wood.name/realPerson.html
   Real Person Form Submission for jQuery v1.0.1.
   Written by Keith Wood (kwood{at}iinet.com.au) June 2009.
   Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
   MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
   Please attribute the author if you use it. */
(function(e){function n(){this._defaults={length:6,includeNumbers:!1,regenerate:"Click to change",hashName:"{n}Hash"}}var t="realPerson",r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=[["   *   ","  * *  ","  * *  "," *   * "," ***** ","*     *","*     *"],["****** ","*     *","*     *","****** ","*     *","*     *","****** "],[" ***** ","*     *","*      ","*      ","*      ","*     *"," ***** "],["****** ","*     *","*     *","*     *","*     *","*     *","****** "],["*******","*      ","*      ","****   ","*      ","*      ","*******"],["*******","*      ","*      ","****   ","*      ","*      ","*      "],[" ***** ","*     *","*      ","*      ","*   ***","*     *"," ***** "],["*     *","*     *","*     *","*******","*     *","*     *","*     *"],["*******","   *   ","   *   ","   *   ","   *   ","   *   ","*******"],["      *","      *","      *","      *","      *","*     *"," ***** "],["*     *","*   ** ","* **   ","**     ","* **   ","*   ** ","*     *"],["*      ","*      ","*      ","*      ","*      ","*      ","*******"],["*     *","**   **","* * * *","*  *  *","*     *","*     *","*     *"],["*     *","**    *","* *   *","*  *  *","*   * *","*    **","*     *"],[" ***** ","*     *","*     *","*     *","*     *","*     *"," ***** "],["****** ","*     *","*     *","****** ","*      ","*      ","*      "],[" ***** ","*     *","*     *","*     *","*   * *","*    * "," **** *"],["****** ","*     *","*     *","****** ","*   *  ","*    * ","*     *"],[" ***** ","*     *","*      "," ***** ","      *","*     *"," ***** "],["*******","   *   ","   *   ","   *   ","   *   ","   *   ","   *   "],["*     *","*     *","*     *","*     *","*     *","*     *"," ***** "],["*     *","*     *"," *   * "," *   * ","  * *  ","  * *  ","   *   "],["*     *","*     *","*     *","*  *  *","* * * *","**   **","*     *"],["*     *"," *   * ","  * *  ","   *   ","  * *  "," *   * ","*     *"],["*     *"," *   * ","  * *  ","   *   ","   *   ","   *   ","   *   "],["*******","     * ","    *  ","   *   ","  *    "," *     ","*******"],["  ***  "," *   * ","*     *","*     *","*     *"," *   * ","  ***  "],["   *   ","  **   "," * *   ","   *   ","   *   ","   *   ","*******"],[" ***** ","*     *","      *","     * ","   **  "," **    ","*******"],[" ***** ","*     *","      *","    ** ","      *","*     *"," ***** "],["    *  ","   **  ","  * *  "," *  *  ","*******","    *  ","    *  "],["*******","*      ","****** ","      *","      *","*     *"," ***** "],["  **** "," *     ","*      ","****** ","*     *","*     *"," ***** "],["*******","     * ","    *  ","   *   ","  *    "," *     ","*      "],[" ***** ","*     *","*     *"," ***** ","*     *","*     *"," ***** "],[" ***** ","*     *","*     *"," ******","      *","     * "," ****  "]];e.extend(n.prototype,{markerClassName:"hasRealPerson",setDefaults:function(t){return e.extend(this._defaults,t||{}),this},_attachRealPerson:function(n,r){n=e(n);if(n.hasClass(this.markerClassName))return;n.addClass(this.markerClassName);var i={settings:e.extend({},this._defaults)};e.data(n[0],t,i),this._changeRealPerson(n,r)},_changeRealPerson:function(n,r,i){n=e(n);if(!n.hasClass(this.markerClassName))return;r=r||{};if(typeof r=="string"){var s=r;r={},r[s]=i}var o=e.data(n[0],t);e.extend(o.settings,r),n.prevAll(".realperson-challenge,.realperson-hash").remove().end().before(this._generateHTML(n,o))},_generateHTML:function(e,t){var n="";for(var s=0;s<t.settings.length;s++)n+=r.charAt(Math.floor(Math.random()*(t.settings.includeNumbers?36:26)));var o='<div class="realperson-challenge"><div class="realperson-text">';for(var s=0;s<i[0].length;s++){for(var u=0;u<n.length;u++)o+=i[r.indexOf(n.charAt(u))][s].replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;";o+="<br>"}return o+='</div><div class="realperson-regen">'+t.settings.regenerate+'</div></div><input type="hidden" class="realperson-hash" name="'+t.settings.hashName.replace(/\{n\}/,e.attr("name"))+'" value="'+this._hash(n)+'">',o},_destroyRealPerson:function(n){n=e(n);if(!n.hasClass(this.markerClassName))return;n.removeClass(this.markerClassName).prevAll(".realperson-challenge,.realperson-hash").remove(),e.removeData(n[0],t)},_hash:function(e){var t=5381;for(var n=0;n<e.length;n++)t=t+5+t+e.charCodeAt(n);return t}}),e.fn.realperson=function(t){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){typeof t=="string"?e.realperson["_"+t+"RealPerson"].apply(e.realperson,[this].concat(n)):e.realperson._attachRealPerson(this,t||{})})},e.realperson=new n,e(".realperson-challenge").live("click",function(){e(this).next().next().realperson("change")})})(jQuery);