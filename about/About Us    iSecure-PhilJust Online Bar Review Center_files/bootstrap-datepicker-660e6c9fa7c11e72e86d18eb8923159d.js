/* ===========================================================
 * bootstrap-datepicker.js v1.3.0
 * http://twitter.github.com/bootstrap/javascript.html#datepicker
 * ===========================================================
 * Copyright 2011 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Contributed by Scott Torborg - github.com/storborg
 * Loosely based on jquery.date_input.js by Jon Leighton, heavily updated and
 * rewritten to match bootstrap javascript approach and add UI features.
 * =========================================================== */
!function(e){function r(e){var t;for(t=0;t<n.length;t++)n[t]!=e&&n[t].hide()}function i(t,r){this.$el=e(t),this.proxy("show").proxy("ahead").proxy("hide").proxy("keyHandler").proxy("selectDate");var r=e.extend({},e.fn.datepicker.defaults,r);if(!!r.parse||!!r.format||!this.detectNative())e.extend(this,r),this.$el.data("datepicker",this),n.push(this),this.init()}var t="[data-datepicker]",n=[];i.prototype={detectNative:function(t){if(navigator.userAgent.match(/(iPad|iPhone); CPU(\ iPhone)? OS 5_\d/i)){var n=e("<span>").insertBefore(this.$el);return this.$el.detach().attr("type","date").insertAfter(n),n.remove(),!0}return!1},init:function(){var t=this.nav("months",1),n=this.nav("years",12),r=e("<div>").addClass("nav").append(t,n);this.$month=e(".name",t),this.$year=e(".name",n),$calendar=e("<div>").addClass("calendar");for(var i=0;i<this.shortDayNames.length;i++)$calendar.append('<div class="dow">'+this.shortDayNames[(i+this.startOfWeek)%7]+"</div>");this.$days=e("<div>").addClass("days"),$calendar.append(this.$days),this.$picker=e("<div>").click(function(e){e.stopPropagation()}).mousedown(function(e){e.preventDefault()}).addClass("datepicker").append(r,$calendar).insertAfter(this.$el),this.$el.focus(this.show).click(this.show).change(e.proxy(function(){this.selectDate()},this)),this.selectDate(),this.hide()},nav:function(t,n){var r=e('<div><span class="prev button">&larr;</span><span class="name"></span><span class="next button">&rarr;</span></div>').addClass(t);return e(".prev",r).click(e.proxy(function(){this.ahead(-n,0)},this)),e(".next",r).click(e.proxy(function(){this.ahead(n,0)},this)),r},updateName:function(t,n){var r=t.find(".fg").text(),i=e("<div>").addClass("fg").append(n);t.empty();if(r!=n){var s=e("<div>").addClass("bg");t.append(s,i),s.fadeOut("slow",function(){e(this).remove()})}else t.append(i)},selectMonth:function(t){var n=new Date(t.getFullYear(),t.getMonth(),1);if(!this.curMonth||this.curMonth.getFullYear()!=n.getFullYear()||this.curMonth.getMonth()!=n.getMonth()){this.curMonth=n;var r=this.rangeStart(t),i=this.rangeEnd(t),s=this.daysBetween(r,i);this.$days.empty();for(var o=0;o<=s;o++){var u=new Date(r.getFullYear(),r.getMonth(),r.getDate()+o,12,0),a=e("<div>").attr("date",this.format(u));a.text(u.getDate()),u.getMonth()!=t.getMonth()&&a.addClass("overlap"),this.$days.append(a)}this.updateName(this.$month,this.monthNames[t.getMonth()]),this.updateName(this.$year,this.curMonth.getFullYear()),e("div",this.$days).click(e.proxy(function(t){var n=e(t.target);this.update(n.attr("date")),n.hasClass("overlap")||this.hide()},this)),e("[date='"+this.format(new Date)+"']",this.$days).addClass("today")}e(".selected",this.$days).removeClass("selected"),e('[date="'+this.selectedDateStr+'"]',this.$days).addClass("selected")},selectDate:function(e){typeof e=="undefined"&&(e=this.parse(this.$el.val())),e||(e=new Date),this.selectedDate=e,this.selectedDateStr=this.format(this.selectedDate),this.selectMonth(this.selectedDate)},update:function(e){this.$el.val(e).change()},show:function(t){t&&t.stopPropagation(),r(this);var n=this.$el.offset();this.$picker.css({top:n.top+this.$el.outerHeight()+2,left:n.left}).show(),e("html").on("keydown",this.keyHandler)},hide:function(){this.$picker.hide(),e("html").off("keydown",this.keyHandler)},keyHandler:function(e){switch(e.keyCode){case 9:case 27:this.hide();return;case 13:this.update(this.selectedDateStr),this.hide();break;case 38:this.ahead(0,-7);break;case 40:this.ahead(0,7);break;case 37:this.ahead(0,-1);break;case 39:this.ahead(0,1);break;default:return}e.preventDefault()},parse:function(e){var t;return(t=e.match(/^(\d{4,4})-(\d{2,2})-(\d{2,2})$/))?new Date(t[1],t[2]-1,t[3]):null},format:function(e){var t=(e.getMonth()+1).toString(),n=e.getDate().toString();return t.length===1&&(t="0"+t),n.length===1&&(n="0"+n),e.getFullYear()+"-"+t+"-"+n},ahead:function(e,t){this.selectDate(new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth()+e,this.selectedDate.getDate()+t))},proxy:function(t){return this[t]=e.proxy(this[t],this),this},daysBetween:function(e,t){var e=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return(t-e)/864e5},findClosest:function(e,t,n){var r=n*(Math.abs(t.getDay()-e-n*7)%7);return new Date(t.getFullYear(),t.getMonth(),t.getDate()+r)},rangeStart:function(e){return this.findClosest(this.startOfWeek,new Date(e.getFullYear(),e.getMonth()),-1)},rangeEnd:function(e){return this.findClosest((this.startOfWeek-1)%7,new Date(e.getFullYear(),e.getMonth()+1,0),1)}},e.fn.datepicker=function(e){return this.each(function(){new i(this,e)})},e(function(){e(t).datepicker(),e("html").click(r)}),e.fn.datepicker.DatePicker=i,e.fn.datepicker.defaults={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],startOfWeek:1}}(window.jQuery||window.ender);